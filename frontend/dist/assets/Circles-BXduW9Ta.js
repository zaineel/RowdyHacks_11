import{u as R,r as a,e as T,c as n,a as t,f as v,w as E,i as y,v as j,l as U,t as u,m as Y,F as q,h as G,j as f,o as i,n as V}from"./index-UQSIJfrq.js";const K={class:"flex justify-between items-center mb-8"},O={class:"flex space-x-3"},Q={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},W={class:"bg-dusty-800 rounded-lg p-6 max-w-md w-full mx-4"},X={class:"mb-6"},Z=["disabled"],ee={class:"flex space-x-3"},te=["disabled"],se=["disabled"],le={key:0,class:"spinner inline-block mr-2"},oe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ne={class:"bg-dusty-800 rounded-lg p-6 max-w-md w-full mx-4"},ie={class:"mb-4"},ae=["disabled"],re={class:"mb-4"},de=["disabled"],ue={class:"mb-6"},ce=["disabled"],ve={class:"flex space-x-3"},be=["disabled"],me=["disabled"],pe={key:0,class:"spinner inline-block mr-2"},fe={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xe={class:"bg-dusty-800 rounded-lg p-6 max-w-md w-full mx-4 border-2 border-red-500/30"},ye={class:"flex space-x-3"},ge=["disabled"],Ce=["disabled"],ke={key:0,class:"spinner inline-block mr-2"},_e={key:3,class:"text-center py-12"},he={key:4,class:"card text-center py-12"},we={key:5,class:"grid md:grid-cols-2 gap-6"},Me=["onClick"],De={class:"flex justify-between items-start mb-4"},Ee={class:"flex-1"},je={class:"text-xl font-semibold text-frontier-400"},Ue={class:"text-sm text-dusty-400"},$e={class:"flex items-center space-x-2"},Pe={key:0,class:"relative"},Se=["onClick"],Ve=["onClick"],ze=["onClick"],Be={class:"grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-dusty-700"},Fe={class:"text-lg font-semibold text-frontier-400"},Je={class:"text-lg font-semibold text-starlight-400"},Ne={class:"mt-4 pt-4 border-t border-dusty-700"},Ae={class:"text-dusty-100"},Re={__name:"Circles",setup(Le){const{user:Ie}=R(),g=a(!1),C=a([]),k=a(!1),m=a(""),c=a(!1),p=a(null),_=a(!1),h=a(!1),w=a(null),M=a(null),r=a({name:"",description:"",status:"active"}),d=a(!1),b=a(!1),z=l=>({active:"badge-success",pending:"badge-warning",completed:"badge-info"})[l]||"badge",B=l=>new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),x=async()=>{g.value=!0;try{const e=(await f.auth.getCurrentUser()).data.data.id,s=await f.users.getCircles(e);C.value=s.data.data}catch(l){console.error("Error loading circles:",l)}finally{g.value=!1}},F=async()=>{var l,e,s;if(!m.value.trim()){alert("Please enter an invite code");return}c.value=!0;try{const o=await f.circles.joinByInviteCode(m.value.trim());alert(o.data.message||"Successfully joined the circle!"),$(),await x()}catch(o){console.error("Error joining circle:",o);const H=((s=(e=(l=o.response)==null?void 0:l.data)==null?void 0:e.error)==null?void 0:s.message)||"Failed to join circle. Please check the invite code and try again.";alert(H)}finally{c.value=!1}},$=()=>{k.value=!1,m.value="",c.value=!1},J=(l,e)=>{e.stopPropagation(),p.value=p.value===l?null:l},D=()=>{p.value=null},N=(l,e)=>{e.stopPropagation(),w.value=l,r.value={name:l.name,description:l.description||"",status:l.status},_.value=!0,D()},P=()=>{_.value=!1,w.value=null,r.value={name:"",description:"",status:"active"},d.value=!1},A=async()=>{var l,e,s;if(!r.value.name.trim()){alert("Please enter a circle name");return}d.value=!0;try{await f.circles.update(w.value.id,{name:r.value.name.trim(),description:r.value.description.trim(),status:r.value.status}),alert("Circle updated successfully!"),P(),await x()}catch(o){console.error("Error updating circle:",o),alert(((s=(e=(l=o.response)==null?void 0:l.data)==null?void 0:e.error)==null?void 0:s.message)||"Failed to update circle")}finally{d.value=!1}},L=(l,e)=>{e.stopPropagation(),M.value=l,h.value=!0,D()},S=()=>{h.value=!1,M.value=null,b.value=!1},I=async()=>{var l,e,s;b.value=!0;try{await f.circles.delete(M.value),alert("Circle disbanded successfully!"),S(),await x()}catch(o){console.error("Error deleting circle:",o),alert(((s=(e=(l=o.response)==null?void 0:l.data)==null?void 0:e.error)==null?void 0:s.message)||"Failed to disband circle")}finally{b.value=!1}};return T(async()=>{await x(),document.addEventListener("click",D)}),(l,e)=>(i(),n("div",null,[t("div",K,[e[8]||(e[8]=t("div",null,[t("h1",{class:"text-3xl font-bold text-frontier-400 mb-2"},"My Circles"),t("p",{class:"text-dusty-300"},"Manage your lending circles")],-1)),t("div",O,[t("button",{onClick:e[0]||(e[0]=s=>k.value=!0),class:"btn-frontier-outline"}," Join Circle "),t("button",{onClick:e[1]||(e[1]=s=>l.$router.push("/circles/create")),class:"btn-frontier"}," + Create New Circle ")])]),k.value?(i(),n("div",Q,[t("div",W,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold text-frontier-400 mb-4"},"Join a Circle",-1)),e[11]||(e[11]=t("p",{class:"text-dusty-300 mb-6"},"Enter the invite code provided by the circle admin",-1)),t("form",{onSubmit:E(F,["prevent"])},[t("div",X,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium mb-2"},"Invite Code",-1)),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>m.value=s),type:"text",required:"",placeholder:"Enter invite code",class:"input-field uppercase",disabled:c.value},null,8,Z),[[j,m.value]])]),t("div",ee,[t("button",{type:"button",onClick:$,class:"btn-frontier-outline flex-1",disabled:c.value}," Cancel ",8,te),t("button",{type:"submit",class:"btn-frontier flex-1",disabled:c.value},[c.value?(i(),n("span",le)):v("",!0),U(" "+u(c.value?"Joining...":"Join Circle"),1)],8,se)])],32)])])):v("",!0),_.value?(i(),n("div",oe,[t("div",ne,[e[16]||(e[16]=t("h2",{class:"text-2xl font-bold text-frontier-400 mb-4"},"Edit Circle",-1)),e[17]||(e[17]=t("p",{class:"text-dusty-300 mb-6"},"Update circle details",-1)),t("form",{onSubmit:E(A,["prevent"])},[t("div",ie,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium mb-2"},"Circle Name",-1)),y(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.name=s),type:"text",required:"",placeholder:"Enter circle name",class:"input-field",disabled:d.value},null,8,ae),[[j,r.value.name]])]),t("div",re,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium mb-2"},"Description",-1)),y(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.description=s),placeholder:"Enter description (optional)",rows:"3",class:"input-field resize-none",disabled:d.value},null,8,de),[[j,r.value.description]])]),t("div",ue,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium mb-2"},"Status",-1)),y(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>r.value.status=s),class:"input-field",disabled:d.value},[...e[14]||(e[14]=[t("option",{value:"active"},"Active",-1),t("option",{value:"paused"},"Paused",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"disbanded"},"Disbanded",-1)])],8,ce),[[Y,r.value.status]])]),t("div",ve,[t("button",{type:"button",onClick:P,class:"btn-frontier-outline flex-1",disabled:d.value}," Cancel ",8,be),t("button",{type:"submit",class:"btn-frontier flex-1",disabled:d.value},[d.value?(i(),n("span",pe)):v("",!0),U(" "+u(d.value?"Updating...":"Update Circle"),1)],8,me)])],32)])])):v("",!0),h.value?(i(),n("div",fe,[t("div",xe,[e[18]||(e[18]=t("h2",{class:"text-2xl font-bold text-red-400 mb-4"},"Disband Circle",-1)),e[19]||(e[19]=t("p",{class:"text-dusty-300 mb-2"},"Are you sure you want to disband this circle?",-1)),e[20]||(e[20]=t("p",{class:"text-sm text-dusty-400 mb-6"},"This action cannot be undone. All members will be notified.",-1)),t("div",ye,[t("button",{onClick:S,class:"btn-frontier-outline flex-1",disabled:b.value}," Cancel ",8,ge),t("button",{onClick:I,class:"flex-1 px-6 py-3 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition-all duration-200",disabled:b.value},[b.value?(i(),n("span",ke)):v("",!0),U(" "+u(b.value?"Disbanding...":"Yes, Disband"),1)],8,Ce)])])])):v("",!0),g.value?(i(),n("div",_e,[...e[21]||(e[21]=[t("div",{class:"spinner mx-auto"},null,-1)])])):C.value.length===0?(i(),n("div",he,[e[22]||(e[22]=t("p",{class:"text-dusty-300 mb-4"},"You're not part of any circles yet",-1)),t("button",{onClick:e[6]||(e[6]=s=>l.$router.push("/circles/create")),class:"btn-frontier"}," Create Your First Circle ")])):(i(),n("div",we,[(i(!0),n(q,null,G(C.value,s=>(i(),n("div",{key:s.id,class:"card-hover cursor-pointer relative",onClick:o=>l.$router.push(`/circles/${s.id}`)},[t("div",De,[t("div",Ee,[t("h3",je,u(s.name),1),t("p",Ue,u(s.description),1)]),t("div",$e,[t("span",{class:V(z(s.status))},u(s.status),3),s.role==="admin"?(i(),n("div",Pe,[t("button",{onClick:o=>J(s.id,o),class:V(["p-2 hover:bg-dusty-700 rounded-lg transition-colors",{"bg-dusty-700":p.value===s.id}])},[...e[23]||(e[23]=[t("svg",{class:"w-5 h-5 text-dusty-300",fill:"currentColor",viewBox:"0 0 16 16"},[t("circle",{cx:"8",cy:"2",r:"1.5"}),t("circle",{cx:"8",cy:"8",r:"1.5"}),t("circle",{cx:"8",cy:"14",r:"1.5"})],-1)])],10,Se),p.value===s.id?(i(),n("div",{key:0,onClick:e[7]||(e[7]=E(()=>{},["stop"])),class:"absolute right-0 mt-1 w-48 bg-dusty-800 border border-dusty-700 rounded-lg shadow-xl z-10"},[t("button",{onClick:o=>N(s,o),class:"w-full px-4 py-2 text-left text-dusty-100 hover:bg-dusty-700 rounded-t-lg transition-colors flex items-center space-x-2"},[...e[24]||(e[24]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),t("span",null,"Edit Circle",-1)])],8,Ve),t("button",{onClick:o=>L(s.id,o),class:"w-full px-4 py-2 text-left text-red-400 hover:bg-dusty-700 rounded-b-lg transition-colors flex items-center space-x-2"},[...e[25]||(e[25]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),t("span",null,"Delete Circle",-1)])],8,ze)])):v("",!0)])):v("",!0)])]),t("div",Be,[t("div",null,[e[26]||(e[26]=t("div",{class:"text-dusty-400 text-sm"},"Monthly Amount",-1)),t("div",Fe,"$"+u(s.monthly_amount),1)]),t("div",null,[e[27]||(e[27]=t("div",{class:"text-dusty-400 text-sm"},"Members",-1)),t("div",Je,u(s.current_members)+"/"+u(s.max_members),1)])]),t("div",Ne,[e[28]||(e[28]=t("div",{class:"text-dusty-400 text-sm mb-1"},"Next Payout",-1)),t("div",Ae,u(B(s.next_payout_date)),1)])],8,Me))),128))]))]))}};export{Re as default};
