import{r as i,f as k,c as a,a as e,d as h,g as _,t as l,j as x,v as w,m as C,b as $,F as B,i as M,k as y,o as n,n as I}from"./index-D8A3FOEl.js";const S={class:"flex justify-between items-center mb-8"},V={class:"flex gap-3"},D={key:0,class:"ml-2 px-2 py-0.5 bg-red-500 text-white rounded-full text-xs"},F={class:"card mb-6"},N={class:"flex flex-wrap gap-4"},R={class:"flex-1 min-w-[200px]"},T={class:"min-w-[150px]"},j={key:0,class:"text-center py-12"},q={key:1,class:"card text-center py-12"},E={key:2,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},L=["onClick"],P={class:"flex items-start justify-between mb-3"},U={class:"text-4xl"},z={class:"text-xl font-semibold text-frontier-400 mb-2"},A={class:"text-sm text-dusty-300 mb-4 line-clamp-2"},H={class:"grid grid-cols-2 gap-3 pt-3 border-t border-dusty-700"},O={class:"text-lg font-semibold text-frontier-400"},Q={key:0},G={class:"text-lg font-semibold text-starlight-400"},J={key:1},K={class:"mt-3 pt-3 border-t border-dusty-700 flex items-center justify-between text-sm"},W={class:"text-dusty-400"},X={class:"font-medium"},Y={class:"text-dusty-400"},st={__name:"Marketplace",setup(Z){const u=i(!1),c=i([]),r=i(""),d=i("all"),p=i(0),v=async()=>{u.value=!0;try{const o={status:"available"};d.value!=="all"&&(o.category=d.value),r.value.trim()&&(o.search=r.value.trim());const t=await y.marketplace.list(o);c.value=t.data.data}catch(o){console.error("Error loading marketplace items:",o),alert("Failed to load items. Please try again.")}finally{u.value=!1}},m=()=>{clearTimeout(m.timeout),m.timeout=setTimeout(()=>{v()},300)},g=o=>{const t={tools:"ðŸ”§",electronics:"ðŸ’»",books:"ðŸ“š",sports:"âš½",household:"ðŸ ",other:"ðŸ“¦"};return t[o]||t.other},b=o=>({available:"badge-success",borrowed:"badge-warning",unavailable:"badge-danger"})[o]||"badge",f=async()=>{try{const o=await y.marketplace.pendingRequests();p.value=o.data.data.length}catch(o){console.error("Error loading pending requests count:",o)}};return k(async()=>{await v(),await f()}),(o,t)=>(n(),a("div",null,[e("div",S,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-3xl font-bold text-frontier-400 mb-2"}," Community Marketplace "),e("p",{class:"text-dusty-300"}," Borrow items from your community, build credit together ")],-1)),e("div",V,[e("button",{onClick:t[0]||(t[0]=s=>o.$router.push("/marketplace/my-dashboard")),class:"btn-frontier-outline"},[t[5]||(t[5]=h(" My Marketplace ",-1)),p.value>0?(n(),a("span",D,l(p.value),1)):_("",!0)]),e("button",{onClick:t[1]||(t[1]=s=>o.$router.push("/marketplace/list")),class:"btn-frontier"}," + List an Item ")])]),e("div",F,[e("div",N,[e("div",R,[x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value=s),onInput:m,type:"text",placeholder:"Search items...",class:"input-field"},null,544),[[w,r.value]])]),e("div",T,[x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>d.value=s),onChange:v,class:"input-field"},[...t[7]||(t[7]=[$('<option value="all">All Categories</option><option value="tools">Tools</option><option value="electronics">Electronics</option><option value="books">Books</option><option value="sports">Sports</option><option value="household">Household</option><option value="other">Other</option>',7)])],544),[[C,d.value]])])])]),u.value?(n(),a("div",j,[...t[8]||(t[8]=[e("div",{class:"spinner mx-auto"},null,-1)])])):c.value.length===0?(n(),a("div",q,[t[9]||(t[9]=e("span",{class:"text-6xl mb-4 block"},"ðŸª",-1)),t[10]||(t[10]=e("p",{class:"text-dusty-300 mb-2"},"No items available yet",-1)),t[11]||(t[11]=e("p",{class:"text-sm text-dusty-400 mb-6"},"Be the first to list something!",-1)),e("button",{onClick:t[4]||(t[4]=s=>o.$router.push("/marketplace/list")),class:"btn-frontier"}," List an Item ")])):(n(),a("div",E,[(n(!0),a(B,null,M(c.value,s=>(n(),a("div",{key:s.id,onClick:tt=>o.$router.push(`/marketplace/${s.id}`),class:"card-hover cursor-pointer"},[e("div",P,[e("div",U,l(g(s.category)),1),e("span",{class:I(b(s.status))},l(s.status),3)]),e("h3",z,l(s.title),1),e("p",A,l(s.description),1),e("div",H,[e("div",null,[t[12]||(t[12]=e("div",{class:"text-xs text-dusty-400"},"Deposit",-1)),e("div",O," $"+l(s.deposit_amount),1)]),s.daily_rate>0?(n(),a("div",Q,[t[13]||(t[13]=e("div",{class:"text-xs text-dusty-400"},"Daily Rate",-1)),e("div",G," $"+l(s.daily_rate)+"/day ",1)])):(n(),a("div",J,[...t[14]||(t[14]=[e("div",{class:"text-xs text-dusty-400"},"Daily Rate",-1),e("div",{class:"text-lg font-semibold text-green-400"},"Free",-1)])]))]),e("div",K,[e("div",W,[e("span",X,l(s.owner_name),1)]),e("div",Y,l(s.total_borrows||0)+" borrows ",1)])],8,L))),128))]))]))}};export{st as default};
